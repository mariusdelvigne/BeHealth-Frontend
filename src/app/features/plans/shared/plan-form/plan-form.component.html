<div class="d-flex justify-content-center align-items-center h-100 p-md-1 p-lg-3 pt-3 rounded">
  <form class="custom-insert-form p-1 p-lg-5 rounded-1 w-100" [formGroup]="form" (submit)="submit()">
    <h3>Create a plan</h3>

    <div class="row">
      <div class="col-12 col-md-8 mt-1">
        <input class="form-control" formControlName="name" placeholder="Title">
      </div>
      <div class="col-12 col-md-4 d-flex justify-content-center gap-1 mt-1">
        <button type="button" class="custom-btn-lock rounded-2" (click)="setPrivacy()">
          <i class="fa-solid"
             [ngClass]="{'fa-lock': form.get('privacy')?.value == 'private', 'fa-lock-open': form.get('privacy')?.value == 'public'}"></i>
        </button>

        <input class="custom-btn rounded-2 custom-btn-lock w-100" type="submit"
               [value]="mode === 'create' ? 'Create' : 'Save'" [disabled]="form.invalid">
      </div>
    </div>
    <div class="row">
      <div class="col-6 col-md-4 mt-1">
        <label for="category">Category</label>
        <select class="form-control" formControlName="category" id="category">
          <option value="sport">sport</option>
          <option value="food">food</option>
          <option value="sleep">sleep</option>
        </select>
      </div>

      <div class="col-6 col-md-4 mt-1">
        <label for="durationInDays">Duration (days)</label>
        <input type="number" class="form-control" formControlName="durationInDays" id="durationInDays">
      </div>

      <div class="col-12 col-md-4 mt-1">
        <label for="tagInput">Tags</label>
        <input #tagInput class="form-control" type="text" list="tagList"
             formControlName="tagInput"
             (keydown.enter)="addTag(tagInput)" id="tagInput">
        <datalist id="tagList">
          @for (tag of tags; track tag.id) {
            <option [value]="tag.name"></option>
          }
        </datalist>
      </div>
    </div>

    <div class="overflow-auto d-flex pt-3" style="max-height: 20vh">
      @for (tag of planTags; track tag.id) {
        <div class="rounded bg-dark-subtle d-flex justify-content-center pt-1 pb-1 ps-2">
            {{ tag.name }}
          <button type="button" class="btn-close btn-close-white" aria-label="Close" (click)="removeTag(tag)">
          </button>
          </div>
      }
    </div>

    <div>
        <textarea class="form-control w-100 mt-2" formControlName="description" placeholder="Description"
                  style="min-height: 25vh"></textarea>
    </div>

    @if (planRawCategory === 'sport') {
      <div class="table-responsive mt-2">
        <app-plan-sport-list [planSports]="planSports" [isEditMode]="true"></app-plan-sport-list>
        <hr class="mb-0">
        <app-plan-sport-create (onPlanSportCreated)="addPlanSport($event)"></app-plan-sport-create>
      </div>
    } @else if (planRawCategory === 'food') {
      <div class="table-responsive mt-5">
        <app-plan-food-list [planFoods]="planFoods" [isEditMode]="true"></app-plan-food-list>
        <hr class="mb-0">
        <app-plan-food-create (onPlanFoodCreated)="addPlanFood($event)"></app-plan-food-create>
      </div>
    } @else {
      <div>
        <app-plan-sleep-form [planSleep]="planSleep"></app-plan-sleep-form>
      </div>
    }
  </form>

</div>
