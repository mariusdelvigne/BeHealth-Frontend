<div class="d-flex flex-column justify-content-center align-items-center h-100 p-5">
  <form class="custom-insert-form p-5" [formGroup]="form" (submit)="submit()">
    <h3>Create a plan</h3>

    <div class="row gy-2">
      <div class="col-12 col-md-6">
        <input class="form-control h-100" formControlName="name" placeholder="Title">
      </div>
      <div class="col-12 col-md-6 d-flex justify-content-center gap-1">
        <button type="button" class="custom-btn-lock rounded-2" (click)="setPrivacy()">
          <i class="fa-solid"
             [ngClass]="{'fa-lock': form.get('privacy')?.value == 'private', 'fa-lock-open': form.get('privacy')?.value == 'public'}"></i>
        </button>

        <input class="custom-btn rounded-2 custom-btn-lock w-100" type="submit"
               [value]="mode === 'create' ? 'Create' : 'Save'" [disabled]="form.invalid">
      </div>

      <div class="row gy-2">
        <div class="col-12 col-md-4">
          <label class="w-100">
            Category
            <select class="form-control h-100" formControlName="category">
              <option value="sport">sport</option>
              <option value="food">food</option>
              <option value="sleep">sleep</option>
            </select>
          </label>
        </div>

        <div class="col-12 col-md-4">
          <label class="w-100">
            Duration (days) <input type="number" class="form-control h-100" formControlName="durationInDays">
          </label>
        </div>

        <div class="col-12 col-md-4">
          <label class="w-100">
          Tags <input #tagInput class="form-control w-100 h-100" type="text" list="tagList"
                 formControlName="tagInput"
                 (keydown.enter)="addTag(tagInput)" id="tagInput">
          <datalist id="tagList">
            @for (tag of tags; track tag.id) {
              <option [value]="tag.name"></option>
            }
          </datalist>
          </label>
        </div>
      </div>
    </div>

    <div>
      @for (tag of planTags; track tag.id) {
        <span class="badge bg-secondary m-1">
            {{ tag.name }}
          <button type="button" class="btn-close btn-close-white ms-2" aria-label="Close" (click)="removeTag(tag)">
          </button>
          </span>
      }
    </div>

    <div>
        <textarea class="form-control w-100 mt-2" formControlName="description" placeholder="Description"
                  style="min-height: 25vh"></textarea>
    </div>

    @if (planRawCategory === 'sport') {
      <div class="table-responsive mt-2">
        <app-plan-sport-list [planSports]="planSports" [isEditMode]="true"></app-plan-sport-list>
        <hr>
        <app-plan-sport-create (onPlanSportCreated)="addPlanSport($event)"></app-plan-sport-create>
      </div>
    } @else if (planRawCategory === 'food') {
      <div class="table-responsive mt-5">
        <app-plan-food-list [planFoods]="planFoods" [isEditMode]="true"></app-plan-food-list>
        <hr>
        <app-plan-food-create (onPlanFoodCreated)="addPlanFood($event)"></app-plan-food-create>
      </div>
    } @else {
      <div>
        <app-plan-sleep-form [planSleep]="planSleep"></app-plan-sleep-form>
      </div>
    }
  </form>

</div>
